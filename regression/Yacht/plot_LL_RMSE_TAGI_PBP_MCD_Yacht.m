clear;clc
%% LL
Layer = 2;metric=2;
if Layer==1
    filename1 = 'UCI_yachtLLtest400Epoch.txt';
    filename2 = 'PBP/lltest_PBP.txt';
    filename3 = 'MCD/lltest_MCD.txt';
    TAGI_LL    = importdata(filename1);
    PBP_LL    = importdata(filename2);
    MCD_LL    = importdata(filename3);

    FigHandle = figure;
    set(FigHandle, 'Position', [100, 100, 600, 400])
    plot(1:400,TAGI_LL,'r','LineWidth',1);hold on;
    plot(1:400,PBP_LL,'b','LineWidth',1);hold on;
    plot(1:400,MCD_LL,'g','LineWidth',1);
    xlabel('Epoch')
    ylabel('LL')
    %ylim([-7, -2.40])
    legend('TAGI-BNI', 'PBP', 'MCD')
    title('Test Log-Likelihood Yacht')
    drawnow
    % savefig('LLtest_Yacht.fig')
    FigHandle = figure;
    set(FigHandle, 'Position', [100, 100, 600, 400])
    plot((1:400)*0.0125,TAGI_LL,'r','LineWidth',1);hold on;
    plot((1:400)*0.122,PBP_LL,'b','LineWidth',1);hold on;
    plot((1:400)*0.043,MCD_LL,'g','LineWidth',1);
    xlabel('Epoch')
    ylabel('LL')
    %ylim([-7, -2.40])
    legend('TAGI-BNI', 'PBP', 'MCD')
    title('Test Log-Likelihood Yacht')
    drawnow
    savefig('LLtest_yacht_timed.fig')
    %% RMSE
    filename1 = 'UCI_yachtRMSEtest400Epoch.txt';
    filename2 = 'PBP/RMSEtest_PBP.txt';
    filename3 = 'MCD/RMSEtest_MCD.txt';
    TAGI_RMSE  = importdata(filename1);
    PBP_RMSE   = importdata(filename2);
    MCD_RMSE   = importdata(filename3);
    FigHandle = figure;
    set(FigHandle, 'Position', [100, 100, 600, 400])
    plot(1:400,TAGI_RMSE,'r','LineWidth',1);hold on;
    plot(1:400,PBP_RMSE,'b','LineWidth',1);hold on;
    plot(1:400,MCD_RMSE,'g','LineWidth',1);
    xlabel('Epoch')
    ylabel('RMSE')
    %ylim([-7, -2.40])
    legend('TAGI-BNI', 'PBP', 'MCD')
    title('Test RMSE Yacht')
    drawnow
    % savefig('RMSEtest_Yacht.fig')
elseif Layer==2
    if metric==1
        filename1 = 'UCI_yachtLLtest_2L100nodes.txt';
        filename2 = 'PBP/lltest_PBP.txt';
        filename3 = 'MCD/lltest_MCD.txt';
        filename4 = 'UCI_yachtLLtest400Epoch.txt';
        filename5 = 'UCI_TAGI_JMLR_yachtLLtest100Epoch.txt';
        filename6 = 'results_DE/lltest_DE.txt';
        DE        = importdata(filename6);
        TAGI_JMLR = importdata(filename5);
        TAGI_LL   = importdata(filename4);
        TAGI_LL1  = importdata(filename1);
        PBP_LL    = importdata(filename2);
        MCD_LL    = importdata(filename3);

        blue=[-577.86754016,208.22037165;-573.4791685,313.43572913;-569.09109921,368.44845354;-564.7024252,413.73955276;-560.31405354,433.50043465;-555.92564409,482.52857953;-551.53700787,505.20869291;-547.14890079,525.52010079;-542.76052913,542.61845669;-538.37215748,557.14416378;-533.98348346,568.73903622;-529.59511181,585.61077165;-525.20700472,595.65611339;-520.8183685,600.16554331;-516.42999685,610.16704252;-512.0415874,618.85644094;-507.65321575,627.81433701;-503.26484409,622.3816063;-498.87647244,640.27528819;-494.48810079,647.09249764;-490.09942677,657.28474961;-485.71135748,662.27244094;-481.32294803,669.06534803;-476.93431181,674.23929449;-472.54590236,679.76144882;-468.15783307,689.96689134;-463.76915906,691.84395591;-459.3807874,698.41712126;-454.99241575,701.71226457;-450.60404409,707.74832126;-446.21567244,712.33530709;-441.82730079,715.73151496;-437.43889134,718.45659213;-433.05025512,726.15802205;-428.66184567,730.40708031;-424.27377638,732.8511874;-419.88510236,736.62776693;-415.49673071,741.44296063;-411.10835906,747.27534614;-406.72025197,745.75093417;-402.33161575,752.70054425;-397.9432063,756.1217915;-393.55483465,757.78525606;-389.16619843,761.32628409;-384.77809134,759.64682457;-380.38971969,767.08314331;-376.00134047,772.19484094;-371.61267402,775.03336063;-367.22458583,778.66248945;-362.83621039,780.31873134;-358.44754016,781.83385701;-354.05916472,785.54236346;-349.67078929,787.37816315;-345.2827011,788.17584;-340.89403465,795.57614362;-336.50565921,795.52455307;-332.11728,798.25234394;-327.72861354,798.40972346;-323.34052535,803.21803465;-318.95214992,803.8787263;-314.56348346,803.96644913;-310.17510803,808.30592882;-305.78701984,806.76629669;-301.39864441,809.70295181;-297.00997417,817.48991622;-292.62159874,811.18861606;-288.23322331,823.10689512;-283.84484409,818.2569222;-279.45646866,815.87678362;-275.06809323,824.12599937;-270.67971402,821.76314835;-266.29104756,829.52870173;-261.90295937,829.50035528;-257.51458394,829.84244031;-253.12591748,832.26308031;-248.73754205,833.72609386;-244.34945386,832.3611137;-239.9607874,836.24569701;-235.57240819,835.51947969;-231.18403276,839.16217701];
        red=[-383.01698268,349.8791811;-183.77749417,523.68249449;15.46171691,575.37025512;214.70093102,591.45766299;413.94013228,438.44091969;613.17936378,637.50935433;614.49634016,637.43981102];

        % plot(blue(:,1),blue(:,2),'b');hold on;plot(red(:,1),red(:,2),'r');
        x1 = -578.06770394;
        x2 = 614.3759622;

        y1 = 170.11207559;
        y2 = 972.07015181;

        xmin = 0;
        xmax = 2000;

        ymin =  -3;
        ymax =  -0.5;

        xmin_PBPMV = 5.56;
        xmin_VMG   = 327.78;
        blue_new(:,1) = (blue(:,1)-x1)/(x2-x1)*(xmax-xmin_PBPMV)+xmin_PBPMV;
        blue_new(:,2) = (blue(:,2)-y1)/(y2-y1)*(ymax-ymin)+ymin;

        red_new(:,1) = (red(:,1)-x1)/(x2-x1)*(xmax-xmin_VMG)+xmin_VMG;
        red_new(:,2) = (red(:,2)-y1)/(y2-y1)*(ymax-ymin)+ymin;
        FigHandle = figure;
        set(FigHandle, 'Position', [100, 100, 600, 400])
        plot((1:400)*0.0125,TAGI_LL,'r','LineWidth',1);hold on;
        plot((1:100)*0.085,TAGI_LL1,'--r','LineWidth',1);hold on;
        plot((1:400)*0.25,PBP_LL,'b','LineWidth',1);hold on;
        plot((1:400)*0.0295,MCD_LL,'g','LineWidth',1);
        plot(blue_new(:,1),blue_new(:,2),'c','LineWidth',1);hold on;
        plot(red_new(:,1),red_new(:,2),'m');hold on;
        plot((1:100)*0.102,TAGI_JMLR,':r','LineWidth',2);
        plot((1:400)*0.041,DE,'k','LineWidth',2); %'color',[.5 .4 .7]
        xlabel('time(s)')
        ylabel('LL')
        ylim([-40, 5])
        legend('TAGI-BNI','TAGI-BNI 2L','PBP','MCD','PBP-MV','VMG','TAGI','DE') %'
        title('Test Log-Likelihood Yacht')
        fig = gcf;
        ax = fig.CurrentAxes;
        set(ax,'xscale','log')
        drawnow
    elseif metric==2
        filename1 = 'UCI_yachtRMSEtest_2L100nodes.txt';
        filename2 = 'PBP/RMSEtest_PBP.txt';
        filename3 = 'MCD/RMSEtest_MCD.txt';
        filename4 = 'UCI_yachtRMSEtest400Epoch.txt';
        filename5 = 'UCI_TAGI_JMLR_yachtRMSEtest100Epoch.txt';
        filename6 = 'results_DE/RMSEtest_DE.txt';
        DE        = importdata(filename6);
        TAGI_JMLR = importdata(filename5);
        TAGI_LL   = importdata(filename4);
        TAGI_LL1  = importdata(filename1);
        PBP_LL    = importdata(filename2);
        MCD_LL    = importdata(filename3);
        blue = [266.87175307,318.76626142;271.47728882,-52.92918425;276.08307402,-90.64138583;280.68856819,-176.6080252;285.29435717,-108.03507402;289.90014614,-302.18468031;294.50563654,-307.83783307;299.11117228,-318.68175118;303.71696126,-323.93034331;308.32245543,-320.94822047;312.92824441,-309.49466457;317.53373858,-346.63268031;322.13952378,-338.7792378;326.74505953,-316.78257638;331.3508485,-312.9279874;335.95634268,-315.82975748;340.56212787,-324.19063937;345.16791685,-280.07845039;349.7734526,-327.99182362;354.37924157,-327.70268976;358.98473197,-344.81933858;363.59052094,-338.30430236;368.19576189,-344.63875276;372.80155087,-342.47931969;377.40704504,-342.3504378;382.0128378,-361.82706142;386.61834331,-349.40692913;391.22411339,-357.01262362;395.82965669,-354.30685984;400.43542677,-356.65269921;405.04123465,-357.6263811;409.64670236,-356.45665512;414.25251024,-350.77685669;418.85805354,-363.51288189;423.46382362,-364.80793701;428.06932913,-359.73539528;432.67509921,-361.13646614;437.28060472,-364.60221732;441.8863748,-371.25770079;446.49161575,-357.22987087;451.09742362,-368.67537638;455.70292913,-368.86813228;460.30869921,-363.99779528;464.91450709,-365.81336693;469.5200126,-355.15230236;474.12582047,-366.3911811;478.73132598,-372.28856693;483.33709606,-373.55145827;487.94263937,-376.42752756;492.54840945,-373.41974173;497.15391496,-370.58222362;501.75968504,-374.24265827;506.36519055,-372.33705827;510.97099843,-369.5895685;515.57650394,-380.71562835;520.18231181,-376.10233701;524.78808189,-377.18203465;529.3935874,-372.81974173;533.99935748,-378.41215748;538.60486299,-375.96347717;543.21070866,-372.60865512;547.81591181,-377.13127559;552.42168189,-370.64519055;557.0272252,-372.30334488;561.63299528,-383.85293858;566.23850079,-369.01984252;570.84427087,-388.30359685;575.44977638,-375.90531024;580.05558425,-368.57605039;584.66108976,-380.29398425;589.26689764,-373.17486614;593.87266772,-383.89889764;598.47817323,-380.0472189;603.0839811,-377.87811024;607.68944882,-379.81908661;612.29529449,-380.01184252;616.9007622,-375.47247874;621.50657008,-379.25249764;626.11207559,-375.2176252;630.71784567,-378.90995906];
        red = [471.36865512,219.46045984;680.47109291,-242.58315591;889.57375748,-254.13690709;1098.67619528,-225.60918425;1307.77859528,0.51303307;1516.88103307,-261.89491654;1518.26211024,-261.79891654];
        
        %plot(blue(:,1),blue(:,2),'b');hold on;plot(red(:,1),red(:,2),'r');
        x1 = 266.66165669;
        x2 = 1518.13689449;
        
        y1 = -501.68764724;
        y2 = 503.86987087;
        
        xmin = 0;
        xmax = 2000;
        
        ymin = 0;
        ymax = 4;
        
        xmin_PBPMV = 5.56;
        xmin_VMG   = 327.78;
        blue_new(:,1) = (blue(:,1)-x1)/(x2-x1)*(xmax-xmin_PBPMV)+xmin_PBPMV;
        blue_new(:,2) = (blue(:,2)-y1)/(y2-y1)*(ymax-ymin)+ymin;
        
        % red_new(:,1) = (red(:,1)-x1)/(x2-x1)*(xmax-xmin_VMG)+xmin_VMG;
        red_new(:,1) = [327.5;700;1000;1300;1700;1998;2002];
        red_new(:,2) = (red(:,2)-y1)/(y2-y1)*(ymax-ymin)+ymin;
        FigHandle = figure;
        set(FigHandle, 'Position', [100, 100, 600, 400])
        plot((1:400)*0.0125,TAGI_LL,'r','LineWidth',1);hold on;
        plot((1:100)*0.085,TAGI_LL1,'--r','LineWidth',1);hold on;
        plot((1:400)*0.25,PBP_LL,'b','LineWidth',1);hold on;
        plot((1:400)*0.0295,MCD_LL,'g','LineWidth',1);
        plot(blue_new(:,1),blue_new(:,2),'c','LineWidth',1);hold on;
        plot(red_new(:,1),red_new(:,2),'m');hold on;
        plot((1:100)*0.102,TAGI_JMLR,':r','LineWidth',2);
        plot((1:400)*0.041,DE,'k','LineWidth',2); %'color',[.5 .4 .7]
        xlabel('time(s)')
        ylabel('LL')
%         ylim([-40, 5])
        legend('TAGI-BNI','TAGI-BNI 2L','PBP','MCD','PBP-MV','VMG','TAGI','DE') %'
        title('Test RMSE Yacht')
        fig = gcf;
        ax = fig.CurrentAxes;
        set(ax,'xscale','log')
        drawnow
    end
end