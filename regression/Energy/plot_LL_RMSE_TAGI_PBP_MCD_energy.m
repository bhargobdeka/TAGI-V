clear;clc

%% LL
Layer = 2;metric=2;
if Layer==1
    %% LL
    filename1 = 'UCI_energyLLtest400Epoch.txt';
    filename2 = 'PBP/lltest_PBP.txt';
    filename3 = 'MCD/lltest_MCD.txt';
    TAGI_LL   = importdata(filename1);
    PBP_LL    = importdata(filename2);
    MCD_LL    = importdata(filename3);

    FigHandle = figure;
    set(FigHandle, 'Position', [100, 100, 600, 400])
    plot(1:400,TAGI_LL,'r','LineWidth',1);hold on;
    plot(1:400,PBP_LL,'b','LineWidth',1);hold on;
    plot(1:400,MCD_LL,'g','LineWidth',1);
    xlabel('Epoch')
    ylabel('LL')
    %ylim([-7, -2])
    legend('TAGI-BNI', 'PBP', 'MCD')
    title('Test Log-Likelihood Energy')
    drawnow
    % savefig('LLtest_Energy.fig')

    %%
    FigHandle = figure;
    set(FigHandle, 'Position', [100, 100, 600, 400])
    plot((1:400)*0.0365,TAGI_LL,'r','LineWidth',1);hold on;
    plot((1:400)*0.267,PBP_LL,'b','LineWidth',1);hold on;
    plot((1:400)*0.137,MCD_LL,'g','LineWidth',1);
    xlabel('Epoch x time per epoch')
    ylabel('LL')
    % ylim([-7, -2.40])
    legend('TAGI-BNI', 'PBP', 'MCD')
    title('Test Log-Likelihood energy')
    drawnow
    savefig('LLtest_energy_timed.fig')
    %% RMSE
    filename1 = 'UCI_energyRMSEtest400Epoch.txt';
    filename2 = 'PBP/RMSEtest_PBP.txt';
    filename3 = 'MCD/RMSEtest_MCD.txt';
    TAGI_RMSE  = importdata(filename1);
    PBP_RMSE   = importdata(filename2);
    MCD_RMSE   = importdata(filename3);
    FigHandle = figure;
    set(FigHandle, 'Position', [100, 100, 600, 400])
    plot(1:400,TAGI_RMSE,'r','LineWidth',1);hold on;
    plot(1:400,PBP_RMSE,'b','LineWidth',1);hold on;
    plot(1:400,MCD_RMSE,'g','LineWidth',1);
    xlabel('Epoch')
    ylabel('RMSE')
    %ylim([-7, -2.40])
    legend('TAGI-BNI', 'PBP', 'MCD')
    title('Test RMSE Energy')
    drawnow
    % savefig('RMSEtest_Energy.fig')
elseif Layer == 2
    if metric == 1
        filename1 = 'UCI_energyLLtest_2L100nodes.txt';
        filename2 = 'PBP/lltest_PBP.txt';
        filename3 = 'MCD/lltest_MCD.txt';
        filename4 = 'UCI_energyLLtest400Epoch.txt';
        filename5 = 'UCI_TAGI_JMLR_EnergyLLtest100Epoch.txt';
        filename6 = 'results_DE/lltest_DE.txt';
        DE        = importdata(filename6);
        TAGI_JMLR = importdata(filename5);
        TAGI_LL   = importdata(filename4);
        TAGI_LL1  = importdata(filename1);
        PBP_LL    = importdata(filename2);
        MCD_LL    = importdata(filename3);

        blue=[-412.20619843,10.11507402;-393.9231874,77.83509921;-375.64056567,118.10294173;-357.35753953,186.70015748;-339.07450961,255.56874331;-320.79148346,299.13792756;-302.50845732,332.81302677;-284.2254274,356.52585827;-265.94240126,381.18126614;-247.65979087,402.25073386;-229.3763452,422.97913701;-211.09331906,-160.23091654;-192.81070866,450.97035591;-174.52726299,464.55783307;-156.2446526,479.75720315;-137.96162646,488.38151811;-119.67860031,500.04498898;-101.39557039,509.94818268;-83.11254425,519.44417008;-64.82993386,529.67969764;-46.54648819,537.67131969;-28.26346205,545.68905827;-9.98085241,551.80335118;8.3025925,562.16847874;26.58532762,568.23942047;44.86818898,575.16661417;63.15146457,582.54474331;81.43432819,588.24260787;99.71714646,594.42920315;118.00046362,601.37332913;136.28332346,606.87809764;154.56614173,610.68903307;172.84900535,616.63661102;191.13228094,622.42412598;209.41514079,626.43847559;227.69800441,631.83125669;245.98128,637.83794646;264.26413984,640.67002205;282.54699969,645.83697638;300.82982173,650.49887244;319.1131389,653.85377008;337.39595717,654.88395591;355.67881701,662.44221732;373.96213795,667.06779213;392.24496378,670.7800063;410.52782362,674.01259843;428.81109921,676.39211339;447.09395906,681.58499528;465.3768189,685.43931969;483.66009449,687.51265512;501.94295433,691.87630866;520.22581417,693.48207874;538.50908976,696.22903937;556.79194961,698.87962205;575.07477165,701.40385512;593.3576315,705.89034331;611.64094488,707.92112126;629.92376693,709.17781417;648.20662677,712.42847244;666.48990236,715.6671874;684.7727622,717.45070866;703.05562205,720.78073701;721.33889764,722.42630551;739.62175748,724.02119055;757.90461732,725.87213858;776.18789291,728.82750236;794.47075276,732.57671811;812.7535748,734.74132913;831.03688819,735.36423307;849.31974803,740.11411654;867.60257008,740.81533228;885.88542992,741.77026772;904.16870551,744.71644724;922.45156535,746.77309984;940.7344252,748.37067213;959.01773858,749.58920315;977.30059843,751.81272567;995.58345827,754.4159811;1013.86673386,754.09585512;1032.1495937,758.24508472;1050.43241575,758.17697764;1068.71527559,758.29618394;1086.99858898,761.96781354;1105.28141102,765.03865701;1123.56427087,765.37242709;1141.84754646,768.25902614;1160.1304063,764.72838803;1178.41326614,771.18356409;1196.69654173,772.37859402;1214.97940157,772.38804283;1233.26226142,771.63744378;1251.54553701,775.33941543;1269.82839685,776.98466646;1288.1112189,776.59268031;1306.39407874,779.93461039;1324.67739213,781.89011528;1342.96021417,781.5243326;1361.24307402,784.41093165;1379.52634961,785.35326614;1397.80920945,786.2812989];

        red = [-404.39569134,186.05574803;-378.30213543,433.51388976;-352.20859465,526.68313701;-326.11463433,569.37214488;-300.02108976,617.08422047;-273.9275452,585.11535118;-247.8335811,641.13668031;-221.74003654,677.45400945;-195.64649197,615.34268976;-169.55252787,652.19164724;-143.45898331,670.22985827;-117.36543874,651.51295748;-91.27147843,667.64908346;-65.17793386,658.08525354;-39.08438929,666.20692913;-12.99042482,680.51697638;13.10303622,670.53346772;39.19653921,659.61671811;65.29050331,651.19589291;91.3840063,677.94073701;117.47755087,617.10625512;143.57151118,674.22149291;169.66501417,644.46735118;195.75851717,612.70854803;221.85248126,636.52418268;247.94602583,682.24490079;274.03952882,685.57560945;300.13348913,672.87741732;326.22699213,678.40497638;352.32053669,686.63826142;378.41450079,669.35909291;404.5080189,686.49539528;430.60149921,685.82105197;456.69505512,710.61471496;482.78902677,703.97986772;508.88250709,692.6791937;534.9760252,684.47716535;561.06999685,680.0792315;587.16351496,621.48173858;613.25703307,660.51847559];

        %plot(blue(:,1),blue(:,2),'b');hold on;plot(red(:,1),red(:,2),'r');
        x1 = -412.33738583;
        x2 = 1398.33622677;

        y1 = -212.73615118;
        y2 = 903.48979276;

        xmax = 1600;
        ymin =  -3;
        ymax =  -0.5;

        xmin_PBPMV = 14.71;
        xmin_VMG = 18.38;
        blue_new(:,1) = (blue(:,1)-x1)/(x2-x1)*(xmax-xmin_PBPMV)+xmin_PBPMV;
        blue_new(:,2) = (blue(:,2)-y1)/(y2-y1)*(ymax-ymin)+ymin;

        red_new(:,1) = (red(:,1)-x1)/(x2-x1)*(xmax-xmin_VMG)+xmin_VMG;
        red_new(:,2) = (red(:,2)-y1)/(y2-y1)*(ymax-ymin)+ymin;

        FigHandle = figure;
        set(FigHandle, 'Position', [100, 100, 600, 400])
        plot((1:400)*0.031,TAGI_LL,'r','LineWidth',1);hold on;
        plot((1:100)*0.179,TAGI_LL1,'--r','LineWidth',1);hold on;
        plot((1:400)*0.375,PBP_LL,'b','LineWidth',1);hold on;
        plot((1:400)*0.051,MCD_LL,'g','LineWidth',1);
        plot(blue_new(:,1),blue_new(:,2),'c','LineWidth',1);hold on;
        plot(red_new(:,1),red_new(:,2),'m');hold on;
        plot((1:99)*0.177,TAGI_JMLR.data,':r','LineWidth',2);
        plot((1:400)*0.102,DE,'k','LineWidth',2); %'color',[.5 .4 .7]
        xlabel('time (s)')
        ylabel('LL')
        ylim([-20, -0.5])
        legend('TAGI-BNI','TAGI-BNI 2L','PBP','MCD','PBP-MV','VMG','TAGI-JMLR','DE') %'
        title('Test Log-Likelihood Energy')
        fig = gcf;
        ax = fig.CurrentAxes;
        set(ax,'xscale','log')
        drawnow
    elseif metric == 2
        filename1 = 'UCI_energyRMSEtest_2L100nodes.txt';
        filename2 = 'PBP/RMSEtest_PBP.txt';
        filename3 = 'MCD/RMSEtest_MCD.txt';
        filename4 = 'UCI_energyRMSEtest400Epoch.txt';
        filename5 = 'UCI_TAGI_JMLR_EnergyRMSEtest100Epoch.txt';
        filename6 = 'results_DE/RMSEtest_DE.txt';
        DE        = importdata(filename6);
        TAGI_JMLR = importdata(filename5);
        TAGI_LL   = importdata(filename4);
        TAGI_LL1  = importdata(filename1);
        PBP_LL    = importdata(filename2);
        MCD_LL    = importdata(filename3);
        
        blue = [-486.02192126,470.52427087;-470.58292913,382.7912315;-455.14389921,334.44733228;-439.70486929,169.89320315;-424.26583937,19.31142047;-408.82684724,-54.7655811;-393.38815748,-86.72462362;-377.94912756,-86.63958425;-362.51011276,-108.77699528;-347.07109417,-119.21725984;-331.63240063,-137.59351181;-316.19305701,666.44742047;-300.75436346,-145.55531339;-285.31502362,-145.09152756;-269.87633008,-157.93901102;-254.43763654,-149.91560315;-238.99829291,-153.60113386;-223.55959937,-153.21165354;-208.12025953,-156.83399055;-192.68156598,-163.46037165;-177.2425474,-162.18281575;-161.80352882,-162.2863748;-146.36451402,-158.83846299;-130.92582047,-168.9016063;-115.48647685,-166.70203465;-100.04778331,-167.89715906;-84.60844346,-171.14256378;-69.16974992,-169.99732913;-53.73073134,-171.52282205;-38.29171276,-175.21651654;-22.85301997,-175.73571024;-7.41367899,-172.45632756;8.02501493,-175.16810079;23.46403238,-177.46522205;38.90305134,-175.6056189;54.34206614,-178.34917795;69.78075969,-181.69179213;85.22010331,-178.10823307;100.65879685,-180.96525354;116.09781543,-182.29228346;131.53683024,-180.94011969;146.97552378,-175.64553071;162.4148674,-183.59002205;177.85356094,-185.80917165;193.29290079,-186.93445039;208.73159433,-186.42742677;224.17061291,-184.95586772;239.6096315,-188.46549921;255.0486463,-190.21421102;270.48734362,-187.97657953;285.92635843,-191.02095118;301.36537701,-188.01796535;316.80439559,-188.0992252;332.24341039,-187.57742362;347.68210772,-187.41112441;363.12144756,-191.0223874;378.56012598,-190.18794331;393.99949606,-187.83870236;409.43818583,-189.08039055;424.87717795,-190.18129134;440.31620787,-189.24411969;455.7552378,-191.03274331;471.19407874,-189.86347087;486.63288189,-188.73781417;502.0720252,-188.31023622;517.51082835,-189.0223748;532.95000945,-192.03087874;548.3887748,-192.00442205;563.82795591,-189.62452913;579.26675906,-193.98655748;594.70594016,-191.60073071;610.14470551,-190.17240945;625.58350866,-191.69385827;641.02268976,-192.00075591;656.46149291,-191.54914016;671.90063622,-190.5047811;687.33943937,-191.2671874;702.77862047,-192.0192;718.21742362,-188.68180157;733.65656693,-192.59788346;749.09537008,-189.84105827;764.53455118,-187.75271811;779.97331654,-189.94117795;795.41249764,-192.73980472;810.85130079,-190.9999748;826.29010394,-192.38762835;841.72928504,-186.19351181;857.16805039,-192.40293543;872.6072315,-192.19581732;888.04603465,-190.07569134;903.48517795,-187.34842205;918.9240189,-189.59788346;934.3631622,-190.37355591;949.80192756,-188.2224;965.24110866,-190.30851024;980.67991181,-191.70247559;996.11905512,-189.09788976;1011.55789606,-191.16034016;1026.99703937,-191.11611969;1042.43584252,-190.5008126];
        
        red  = [-479.42604094,208.18680945;-457.39147087,-5.63081575;-435.35690079,-43.39804724;-413.32233071,-63.21316535;-391.28742047,-87.98074961;-369.25285417,-58.58547402;-347.21828031,-100.33799055;-325.18370646,-110.52105827;-303.14880756,-75.73300157;-281.1142337,-96.91211339;-259.07965984,-104.27501102;-237.04476094,-95.86325669;-215.01051213,-100.9775622;-192.97561323,-97.96127244;-170.94103937,-93.37946457;-148.90646551,-112.55829921;-126.87157039,-91.67538898;-104.83699654,-93.51722835;-82.8024189,-92.91152126;-60.76784504,-99.53669291;-38.73327118,-69.74377323;-16.69837493,-101.05080945;5.33619893,-100.61661732;27.37077317,-64.24119685;49.40567055,-84.32235591;71.44024441,-98.42029606;93.47449701,-111.87911811;115.50939213,-98.60704252;137.54396598,-100.27411654;159.57886488,-100.82139213;181.61343874,-90.65404724;203.6480126,-105.55052598;225.6829115,-99.74195906;247.71716031,-114.74830866;269.75173417,-107.67960945;291.78663307,-102.99314646;313.82120693,-100.17308976;335.85610583,-101.44251969;357.89067969,-66.34858583;379.92525354,-88.23764409];
        
        % plot(blue(:,1),blue(:,2),'b');hold on;plot(red(:,1),red(:,2),'r');
        x1 = -486.13224567;
        x2 = 1042.8808063;
        
        y1 = -293.53035591;
        y2 = 929.99828409;
        
        xmin = 0;
        xmax = 15125;
        
        ymin = 0;
        ymax = 4;
        
        xmin_PBPMV = 14.71;
        xmin_VMG = 18.38;
        blue_new(:,1) = (blue(:,1)-x1)/(x2-x1)*(xmax-xmin_PBPMV)+xmin_PBPMV;
        blue_new(:,2) = (blue(:,2)-y1)/(y2-y1)*(ymax-ymin)+ymin;
        
        red_new(:,1) = (red(:,1)-x1)/(x2-x1)*(xmax-xmin_VMG)+xmin_VMG;
        red_new(:,2) = (red(:,2)-y1)/(y2-y1)*(ymax-ymin)+ymin;
        FigHandle = figure;
        set(FigHandle, 'Position', [100, 100, 600, 400])
        plot((1:400)*0.031,TAGI_LL,'r','LineWidth',1);hold on;
        plot((1:100)*0.179,TAGI_LL1,'--r','LineWidth',1);hold on;
        plot((1:400)*0.375,PBP_LL,'b','LineWidth',1);hold on;
        plot((1:400)*0.051,MCD_LL,'g','LineWidth',1);
        plot(blue_new(:,1),blue_new(:,2),'c','LineWidth',1);hold on;
        plot(red_new(:,1),red_new(:,2),'m');hold on;
        plot((1:99)*0.177,TAGI_JMLR(2:100),':r','LineWidth',2);
        plot((1:400)*0.102,DE,'k','LineWidth',2);
        xlabel('time (s)')
        ylabel('LL')
%         ylim([-20, -0.5])
        legend('TAGI-BNI','TAGI-BNI 2L','PBP','MCD','PBP-MV','VMG','TAGI-JMLR','DE') %'
        title('Test RMSE Energy')
        fig = gcf;
        ax = fig.CurrentAxes;
        set(ax,'xscale','log')
        drawnow
    end
end