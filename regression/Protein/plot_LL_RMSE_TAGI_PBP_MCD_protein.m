clear;clc;
metric = 2;
if metric == 1
    filename1 = 'UCI_proteinLLtest_2L100nodes.txt';
    filename2 = 'PBP/lltest_PBP.txt';
    filename3 = 'MCD/lltest_MCD.txt';
    filename4 = 'UCI_proteinLLtest400Epoch.txt';
    filename5 = 'UCI_TAGI_JMLR_proteinLLtest100Epoch.txt';
    filename6 = 'results_DE/lltest_DE.txt';
    DE        = importdata(filename6);
    TAGI_JMLR = importdata(filename5);
    TAGI_LL   = importdata(filename4);
    TAGI_LL1  = importdata(filename1);
    PBP_LL    = importdata(filename2);
    MCD_LL    = importdata(filename3);
    
    blue=[81.5242885,-193.94018268;93.23319307,6.41979213;104.94240756,93.99651024;116.65131591,157.54049764;128.36022047,194.97804094;140.06943874,246.39428031;151.77834331,276.87091654;163.4875578,302.11460787;175.19646614,349.18314331;186.90537449,358.60932283;198.61458898,388.13688189;210.32349354,387.75711496;222.03240189,427.26190866;233.74158992,425.88355276;245.45049449,436.66503307;257.15970898,432.34098898;268.86861732,468.05419843;280.57752189,482.44187717;292.28674016,493.55750551;303.99564472,492.29450079;315.70455307,478.99770709;327.41376756,511.05463937;339.12267591,536.27470866;350.83158047,515.17137638;362.54079496,550.61457638;374.24970331,540.21312756;385.95862677,560.21571024;397.66779213,551.54452913;409.37669291,557.28491339;421.08593386,580.27963465;432.79483465,573.70212283;444.50373543,587.40147402;456.21293858,586.17222047;467.92183937,515.03750551;479.63077795,560.41319055;491.3399811,545.17235906;503.04888189,537.35376378;514.75778268,546.44828976;526.46698583,555.16028976;538.17592441,575.36148661;549.88508976,553.18333228;561.59402835,574.42703622;573.30292913,554.21710866;585.01213228,557.89111181;596.72103307,565.5488126;608.43023622,578.99300787;620.13913701,570.69172913;631.84807559,592.44623622;643.55697638,581.91847559;655.26617953,599.07242835;666.97508031,585.04452283;678.68432126,610.33685669;690.39322205,597.63556535;702.10212283,604.59874016;713.81132598,607.86651969;725.52022677,594.93286299;737.22916535,607.60943622;748.93833071,599.69884724;760.6472315,617.77432441;772.35647244,609.12056693;784.06537323,604.05637795;795.77427402,612.56866772];
    
    red=[658.13465197,432.56768504;1246.45417323,514.12244409];
    % plot(blue(:,1),blue(:,2),'b');hold on;plot(red(:,1),red(:,2),'r');
    x1 = 81.5242885;
    x2 = 1246.45417323;
    
    y1 = -206.27327244;
    y2 = 699.8840315;
    
    xmin = 0;
    xmax = 4.5e04;
    
    ymin =  -2.95;
    ymax =  -2.75;
    
    blue_new(:,1) = (blue(:,1)-x1)/(x2-x1)*(xmax-xmin)+xmin;
    blue_new(:,2) = (blue(:,2)-y1)/(y2-y1)*(ymax-ymin)+ymin;
    
    red_new(:,1) = (red(:,1)-x1)/(x2-x1)*(xmax-xmin)+xmin;
    red_new(:,2) = (red(:,2)-y1)/(y2-y1)*(ymax-ymin)+ymin;

    
    FigHandle = figure;
    set(FigHandle, 'Position', [100, 100, 600, 400])
    plot((1:400)*2.327,TAGI_LL,'r','LineWidth',1);hold on;
    plot((1:100)*9.65,TAGI_LL1,'--r','LineWidth',1);hold on;
    plot((1:400)*11.075,PBP_LL,'b','LineWidth',1);hold on;
    plot((1:400)*1.193,MCD_LL,'g','LineWidth',1);
    plot(blue_new(:,1),blue_new(:,2),'c','LineWidth',1);hold on;
    plot(red_new(:,1),red_new(:,2),'m');hold on;
    plot((1:100)*6.23,TAGI_JMLR,':r','LineWidth',2);
    plot((1:400)*3.506,DE,'k','LineWidth',2); %'color',[.5 .4 .7]
    xlabel('time(s)')
    ylabel('LL')
%     ylim([-3, -2.7])
    legend('TAGI-BNI','TAGI-BNI 2L','PBP','MCD','PBP-MV','VMG','TAGI-JMLR','DE') %'
    title('Test Log-Likelihood Protein')
    fig = gcf;
    ax = fig.CurrentAxes;
    set(ax,'xscale','log')
    drawnow
elseif metric == 2
    filename1 = 'UCI_proteinRMSEtest_2L100nodes.txt';
    filename2 = 'PBP/RMSEtest_PBP.txt';
    filename3 = 'MCD/RMSEtest_MCD.txt';
    filename4 = 'UCI_proteinRMSEtest400Epoch.txt';
    filename5 = 'UCI_TAGI_JMLR_proteinRMSEtest100Epoch.txt';
    filename6 = 'results_DE/RMSEtest_DE.txt';
    DE        = importdata(filename6);
    TAGI_JMLR = importdata(filename5);
    TAGI_LL   = importdata(filename4);
    TAGI_LL1  = importdata(filename1);
    PBP_LL    = importdata(filename2);
    MCD_LL    = importdata(filename3);
    
    blue = [-298.09514079,744.06500787;-285.15830551,561.42372283;-272.2215874,492.36884409;-259.28452157,435.56023937;-246.34774677,405.80851654;-233.41096819,370.58120315;-220.47421984,343.52095748;-207.53712756,329.65458898;-194.60037921,296.34572598;-181.66360063,291.75265512;-168.72682583,269.10606614;-155.78976,278.78407559;-142.85298142,240.85489134;-129.91623685,247.76806299;-116.97945827,243.70624252;-104.0423622,252.88508976;-91.10561764,230.66702362;-78.16883906,211.88908346;-65.23206425,211.06964409;-52.29531591,223.16738268;-39.35821984,224.18229921;-26.42147301,194.30494488;-13.48469631,185.34712441;-0.54792008,197.2479874;12.38914658,175.77029291;25.3259229,177.65914961;38.2627011,168.43328504;51.19944567,178.87453228;64.13654173,170.84840315;77.07329008,159.86853543;90.01006488,167.7295748;102.94684346,160.1631874;115.88358803,157.94581417;128.82068409,169.47620787;141.75743244,148.5279874;154.69421102,160.6336252;167.63098583,162.74740157;180.56805165,169.75226457;193.50483024,152.66010709;206.44160504,150.16648819;219.37835339,157.53017953;232.31512819,146.34980787;245.25219402,156.26713701;258.1889726,165.86691024;271.1257474,150.17106142;284.06249575,145.82006929;296.99959181,147.26910236;309.93636661,139.68196535;322.87311496,143.78868661;335.80988976,132.09936378;348.74695937,142.86984567;361.68373417,134.5744252;374.62050898,145.68755906;387.55725354,131.18997165;400.49434961,136.0392189;413.43110551,134.96806299;426.36786142,130.43489764;439.30465512,138.32745827;452.24171339,126.5775874;465.17850709,128.02174488;478.11526299,136.81848189;491.0520189,131.86193386];
    
    red = [338.97940913,203.75077795;988.99075276,147.08462362];
    
    % plot(blue(:,1),blue(:,2),'b');hold on;plot(red(:,1),red(:,2),'r');
    x1 = -298.09514079;
    x2 = 988.99075276;
    
    y1 = 2.67730394;
    y2 = 916.64777197;
    
    xmin = 0;
    xmax = 4.52e04;
    
    ymin = 3.8;
    ymax = 4.8;
    
    xmin_PBPMV = 556;
    xmin_VMG   = 21296;
    blue_new(:,1) = (blue(:,1)-x1)/(x2-x1)*(xmax-xmin_PBPMV)+xmin_PBPMV;
    blue_new(:,2) = (blue(:,2)-y1)/(y2-y1)*(ymax-ymin)+ymin;
    
    % red_new(:,1) = (red(:,1)-x1)/(x2-x1)*(xmax-xmin_VMG)+xmin_VMG;
    red_new(:,1) = [21296;45128];
    red_new(:,2) = (red(:,2)-y1)/(y2-y1)*(ymax-ymin)+ymin;
    FigHandle = figure;
    set(FigHandle, 'Position', [100, 100, 600, 400])
    plot((1:400)*2.327,TAGI_LL,'r','LineWidth',1);hold on;
    plot((1:100)*9.65,TAGI_LL1,'--r','LineWidth',1);hold on;
    plot((1:400)*11.075,PBP_LL,'b','LineWidth',1);hold on;
    plot((1:400)*1.193,MCD_LL,'g','LineWidth',1);
    plot(blue_new(:,1),blue_new(:,2),'c','LineWidth',1);hold on;
    plot(red_new(:,1),red_new(:,2),'m');hold on;
    plot((1:100)*6.23,TAGI_JMLR,':r','LineWidth',2);
    plot((1:400)*3.506,DE,'k','LineWidth',2); %'color',[.5 .4 .7]
    xlabel('time (s)')
    ylabel('RMSE')
%     ylim([-3, -2.7])
    legend('TAGI-BNI','TAGI-BNI 2L','PBP','MCD','PBP-MV','VMG','TAGI-JMLR','DE') %'
    title('Test RMSE Protein')
    fig = gcf;
    ax = fig.CurrentAxes;
    set(ax,'xscale','log')
    drawnow
end